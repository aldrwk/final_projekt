<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.spring.boot.mapper.MemberMapper">
    <select id="idcheck" resultType="member" parameterType="String">
        select *
        from member3
        where id = #{id}
    </select>
    <insert id="insert" parameterType="member">
        insert into member3
        values (#{id}, #{password}, #{name}, #{age}, #{gender}, #{email}, #{auth})
    </insert>
    <select id="memberinfo" parameterType="String" resultType="member">
        select *
        from member3
        where id = #{id}
    </select>

    <update id="update" parameterType="member">
        update member3
        set password = #{password},
            name     = #{name},
            age      = #{age},
            gender   = #{gender},
            email    = #{email}
        where id = #{id}
    </update>
    <select id="searchlist" parameterType="java.util.Map" resultType="member">
        select * from ( select rownum rnum, b.* from
        (select * from member3 where id != 'admin'
        <include refid="search_"></include>
        order by id) b
        where rownum &lt;= #{end}
        ) where rnum &gt;= #{start} and rnum &lt;= #{end}
    </select>
    <select id="searchlistcount" parameterType="java.util.Map" resultType="int">
        select count(*) from member3 where id != 'admin'
        <include refid="search_"></include>

    </select>
    <delete id="delete" parameterType="String">
        delete from member3 where id = #{id}
    </delete>
    

    <sql id="search_">
        <if test="search_field != null">
            and
            <choose>
                <when test="search_field == 'id'">id</when>
                <when test="search_field == 'name'">name</when>
                <when test="search_field == 'age'">age</when>
                <when test="search_field == 'gender'">gender</when>
            </choose>
            like #{search_word}
        </if>
    </sql>
</mapper>